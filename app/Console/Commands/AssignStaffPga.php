<?php

namespace App\Console\Commands;

use App\User;
use Spatie\Permission\Models\Role;
use Illuminate\Console\Command;

class AssignStaffPga extends Command
{
    protected $staffs = [
        '197205261993031001',
        '196205261989031001',
        '196206041984031002',
        '196212011989031001',
        '196212311986031010',
        '196304281989031001',
        '196309131984031001',
        '196312091984031001',
        '196402151988031001',
        '196406191993031001',
        '196412101988031002',
        '196503041989031001',
        '196504031986031003',
        '196505151989031002',
        '196509091986031002',
        '196602131989031001',
        '196803231991031002',
        '197004041992031002',
        '197011011992031003',
        '197012011993031001',
        '197201051992031004',
        '197207171993031002',
        '196202271990031001',
        '196304231990031001',
        '196308191984031001',
        '196311041986031001',
        '196404091984031002',
        '196405151989031001',
        '196412311990031014',
        '196504101991031001',
        '196505241993031001',
        '196601231990061001',
        '196603171990031001',
        '196603231992031002',
        '196701251992031002',
        '196808101990031002',
        '196809021991031003',
        '196904231992031001',
        '196905021992031012',
        '196905161991011001',
        '197201191993031001',
        '197212151993031002',
        '197301281993031001',
        '197303071993031001',
        '197404051994031003',
        '197407021997031002',
        '197503251995031001',
        '196204141984031004',
        '196409121997031002',
        '196505131992031001',
        '196512301991031002',
        '196809281997031001',
        '196811101996031003',
        '197011191995031001',
        '197012301995031001',
        '197104092002121001',
        '197202132003121001',
        '197212311996031001',
        '197305051995031002',
        '197502042009121001',
        '197708022009121002',
        '197903072009121002',
        '198205112009121002',
        '198305152010121001',
        '198309202009121003',
        '198408102009121004',
        '198408262009121004',
        '198701022009121001',
        '196408071996031001',
        '196507202005021001',
        '196508121991031003',
        '196512071986031004',
        '196512311990031010',
        '196705152002121002',
        '196904122003121001',
        '197007242003121001',
        '197103202005021001',
        '197111231996031001',
        '197307311994031002',
        '197604301997031001',
        '197701102002121002',
        '197702252003121001',
        '198101032005021009',
        '198112132006041002',
        '198201042009121001',
        '198205102010121001',
        '198308252009121003',
        '198509132009121001',
        '198607312009121003',
        '198704192009121002',
        '198906052010121003',
        '196801152005021001',
        '196812112005021001',
        '197004192003121002',
        '197011202007011001',
        '197109042007011001',
        '197111042005021001',
        '197504052002121002',
        '197701152006041002',
        '197805272005021001',
        '197807222006041001',
        '197902042005021003',
        '197905242009121001',
        '198109202009011002',
        '198212172009121004',
        '198309052010121001',
        '198310052009121004',
        '198407312009121002',
        '198408202009121002',
        '198501112014021003',
        '198508092014021001',
        '198511272015031003',
        '198602262005021001',
        '198604182015031001',
        '198606132015031001',
        '198609102006041001',
        '198610082014021002',
        '198610212015031005',
        '198610282009121002',
        '198612202009121004',
        '198701242015031004',
        '198702022006041002',
        '198703222015031003',
        '198707032009121002',
        '198707212009121002',
        '198707302014021003',
        '198802282015031004',
        '198805312014021001',
        '198806282014021003',
        '198807142015031003',
        '198808192015031004',
        '198811202015031003',
        '198903102015031007',
        '198903272010121001',
        '198905302015031007',
        '198910142015031006',
        '198911112015031004',
        '198911202015031004',
        '199001142015031007',
        '199006062015031005',
        '199011142015031002',
        '199012112015031002',
        '199012292014021003',
        '199105312015031003',
        '199210132015031001',
        '196205201993031001',
        '196805042005021001',
        '196812311989031002',
        '197704092009121001',
        '198104232009121002',
        '198105032010121002',
        '198201172009121001',
        '198204302010121001',
        '198207302010121004',
        '198301042009011003',
        '198302052009121001',
        '198408232009121004',
        '198510052009011003',
        '198510092010121002',
        '198512022009011001',
        '198605172010121002',
        '198612042010121001',
        '198701152009011001',
        '198702122010121004',
        '198703132009121003',
        '198710122009011001',
        '198804212018011003',
        '198807282018011001',
        '198808302009121001',
        '198809242018011002',
        '198902192009011001',
        '198904012018011003',
        '198906052018011001',
        '199001212018011003',
        '199004212018011001',
        '199012032018011002',
        '199111152018011001',
        '199208272015031004',
        '199303172018011002',
        '199309172018011004',
        '199406082018011005',
        '199407172015031001',
        '198601152015031003',
        '198703072015031006',
        '198802172015031006',
        '198812092015031004',
        '198902072015031002',
        '199005152014021002',
        '199105092014021001',
        '199105192015031002',
        '199108162015031002',
        '199201312014021001',
        '199209032015031001',
        '199210232014021001',
        '199406112014021001',
        '199506022015031001',
        '199603182015031001',
        '198203062009011003',
        '198511012015031001',
        '198810182018011001',
        '199005052018011003',
        '199012272018011002',
        '199104032018011002',
        '199112182018011002',
        '199206172015031004',
        '199309032018011002',
        '199403022018011002',
        '199606252018011001',
        '199610132018011001',
        '199805032018011002',
    ];

    /**
     * The name and signature of the console command.
     *
     * @var string
     */
    protected $signature = 'role:staff_pga';

    /**
     * The console command description.
     *
     * @var string
     */
    protected $description = 'Menambahkan Role Pengamat Gunung Api';
    protected $role;
    protected $users;

    protected function createRole()
    {
        $this->role->name = 'Pengamat Gunung Api';
        $this->role->save();
        return $this;
    }

    protected function addRole()
    {
        $this->users->each(function ($nip,$key) {
            $user = User::where('nip',$nip)->first();
            $user ? $user->assignRole('Pengamat Gunung Api') : false;
        });
        return $this;
    }

    /**
     * Create a new command instance.
     *
     * @return void
     */
    public function __construct()
    {
        parent::__construct();
    }

    /**
     * Execute the console command.
     *
     * @return mixed
     */
    public function handle()
    {
        $this->info('Sedang menambahkan role Pengamat Gunung Api...');

        $this->role = new Role();
        $this->users = collect($this->staffs);

        Role::where('name','Pengamat Gunung Api')->exists() 
            ? $this->addRole() 
            : $this->createRole()->addRole();

        $this->info('Berhasil menambahkan role Pengamat Gunung Api');
    }
}
